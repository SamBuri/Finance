/*
 Sam Buriima
generated by Saburi Tools
 */
package com.saburi.finance.controllers;

import com.saburi.common.controllers.AbstractViewController;
import com.saburi.common.dbaccess.DBAccess;
import static com.saburi.common.utils.FXUIUtils.errorMessage;
import com.saburi.common.utils.Navigation;
import com.saburi.common.utils.Utilities.FormMode;
import com.saburi.finance.dbaccess.ItemTemplateDA;
import com.saburi.finance.utils.FinanceNavigate;
import java.io.IOException;
import java.net.URL;
import java.util.ResourceBundle;
import javafx.application.Platform;
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.control.MenuItem;
import javafx.scene.control.TableView;
import static org.kordamp.desktoppanefx.scene.layout.DesktopPane.resolveInternalWindow;
import org.kordamp.desktoppanefx.scene.layout.InternalWindow;

public class ItemTemplateViewController extends AbstractViewController {

    @FXML
    private TableView<DBAccess> tblItemTemplate;
    @FXML
    private MenuItem cmiCreateItem;
   
    @Override
    public void initialize(URL url, ResourceBundle rb) {
        this.tableView = tblItemTemplate;
        initSearchEvents();
        cmiCreateItem.setOnAction(e -> {
            try {
                String uiName = "Item";
                FXMLLoader loader = FinanceNavigate.getUILoader(uiName);
                Parent root = loader.load();
                ItemController controller = loader.<ItemController>getController();
                controller.setFormMode(FormMode.Save);
                controller.init(uiName, FormMode.Save);
                controller.loadItem((ItemTemplateDA) tblItemTemplate.getSelectionModel().getSelectedItem());
                float size = controller.getMinSize();
                InternalWindow window = new InternalWindow(uiName, null, uiName, root);
                if (size > 0) {
                    window.setMinWidth(size);
                }
                 resolveInternalWindow(window).center();
                  Navigation.getDesktopPane().addInternalWindow(window);
           
            } catch (IOException ex) {
                Platform.runLater(()->errorMessage(ex));
            }
        });

    }

}
